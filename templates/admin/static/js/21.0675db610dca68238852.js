webpackJsonp([21],{"Mr/s":function(t,e){},Zody:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r=o("bOdI"),s=o.n(r),n=o("zL8q"),i=o("F+jZ"),l={name:"productMes",data:function(){return{editBedRoom:!1,roid:"",showStatus:!1,showRoomOperate:!1,roomData:{},showRoomOperateNo:!1,roomDataNo:{},roomInfo:{num:0,roomData:[]},roomDataRules:{bbrnum:[{required:!0,message:"请输入",trigger:"change"}],bbrshowprice:[{required:!0,message:"请输入",trigger:"change"}],bbrshowpriceunit:[{required:!0,message:"请选择",trigger:"change"}]},roomDataNoRules:{bbrnum:[{required:!0,message:"请输入",trigger:"change"}],usgender:[{required:!0,message:"请选择",trigger:"change"}]},loading:!1,search:"",multipleSelection:[],tableData:[],currentPage:1,total:0,pageSize:10}},created:function(){this.getData()},methods:(a={handleEditRoom:function(t,e){console.log(e),this.editBedRoom=!0,t?(this.roomDataNo.bbrid=e.bbrid,this.roomDataNo.bbrnum=e.bbrnum,e.user&&(this.roomDataNo.usgender="男"==e.user.usgender?0:1),this.showRoomOperateNo=!0):(this.roomData.bbrid=e.bbrid,this.roomData.bbrnum=e.bbrnum,this.roomData.bbrshowprice=e.bbrshowprice,this.roomData.bbrshowpriceunit=e.bbrshowpriceunit,this.showRoomOperate=!0)},handleDeleteRoom:function(t){var e=this,o={bbrid:t};Object(n.MessageBox)({title:"提示",message:"此操作将永久删除数据, 是否继续？",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(t,a,r){"confirm"===t?(a.confirmButtonLoading=!0,a.confirmButtonText="执行中...",e.$http({method:"POST",url:"/room/delete_bedroom/",params:{token:e.Cookie.get("token")},data:o}).then(function(t){a.confirmButtonLoading=!1,200==t.status?(Object(n.Message)({type:"success",message:t.message,duration:1e3}),e.editRoom(e.roid)):Object(n.Message)({type:"error",message:t.message,duration:1e3}),a.confirmButtonLoading=!1,r()})):r()}})},submitRoom:function(t){var e=this;this.roomData.roid=this.roid,this.roomDataNo.roid=this.roid,this.$refs[t].validate(function(o){if(!o)return!1;var a="/room/add_bedroom/";e.editBedRoom&&(a="/room/update_bedroom/"),e.$http({method:"post",url:a,data:"roomData"==t?e.roomData:e.roomDataNo,params:{token:e.Cookie.get("token")}}).then(function(t){200==t.status?(Object(n.Message)({message:t.message,type:"success",showClose:!0}),e.showRoomOperate=!1,e.showRoomOperateNo=!1,e.roomData={},e.roomDataNo={},e.editRoom(e.roid)):Object(n.Message)({message:t.message,type:"error",showClose:!0})})})},handleClose:function(t){t(),this.showRoomOperate=!1,this.showRoomOperateNo=!1,this.roomData={},this.roomDataNo={}},close:function(){this.showRoomOperate=!1,this.showRoomOperateNo=!1,this.showStatus=!1,this.roomData={},this.roomDataNo={}},editRoom:function(t){var e=this;this.showStatus=!0,this.roid=t,this.$http("/room/get_detail/?roid="+t).then(function(t){200==t.status&&(e.roomInfo.num=t.data.house.hobedroomcount,e.roomInfo.roomData=t.data.rooms_in_same_house?t.data.rooms_in_same_house:[])})},getWinHeight:i.d},s()(a,"getWinHeight",i.d),s()(a,"setShowHome",function(t,e){var o=this,a={roid:e.roid,rotype:"0",rosort:2},r={roid:e.roid};t?this.$http({method:"POST",url:"/index/add_room_show/",data:a,params:{token:this.Cookie.get("token")}}).then(function(t){200==t.status?(Object(n.Message)({type:"success",message:t.message,duration:1e3}),o.getData()):Object(n.Message)({type:"error",message:t.message,duration:1e3})}):this.$http({method:"POST",url:"/index/delete_room_show_byroid/",data:r,params:{token:this.Cookie.get("token")}}).then(function(t){200==t.status?(Object(n.Message)({type:"success",message:t.message,duration:1e3}),o.getData()):Object(n.Message)({type:"error",message:t.message,duration:1e3})})}),s()(a,"handleCurrentChange",function(t){this.currentPage=t,this.search?this.searchData(t):this.getData()}),s()(a,"formatter",function(t){return t.releasetime=t.releasetime.substr(0,10),t.releasetime}),s()(a,"handleSelectionChange",function(t){this.multipleSelection=t.map(function(t){return t.ID})}),s()(a,"handleEdit",function(t){this.$router.push("/jointRent/rentOperate/"+t+"?from=jointRent")}),s()(a,"handleDelete",function(t){var e=this,o={roid:t};Object(n.MessageBox)({title:"提示",message:"此操作将永久删除数据, 是否继续？",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(t,a,r){"confirm"===t?(a.confirmButtonLoading=!0,a.confirmButtonText="执行中...",e.$http({method:"POST",url:"/room/delete_room/",params:{token:e.Cookie.get("token")},data:o}).then(function(t){a.confirmButtonLoading=!1,200==t.status?(Object(n.Message)({type:"success",message:t.message,duration:1e3}),e.getData()):Object(n.Message)({type:"error",message:t.message,duration:1e3}),a.confirmButtonLoading=!1,r()})):r()}})}),s()(a,"getData",function(){var t=this;this.loading=!0,this.$http({method:"get",url:"/room/get_list/",params:{type:"0",page:this.currentPage,count:this.pageSize}}).then(function(e){200==e.status?e.data?(t.tableData=e.data,t.total=e.all_count):(t.tableData=null,t.total=e.all_count):(t.tableData=null,t.total=e.all_count,Object(n.Message)({type:"error",message:e.message,duration:2e3})),t.loading=!1}).catch(function(){t.loading=!1})}),s()(a,"searchData",function(){var t=this;this.loading=!0,this.$http({method:"get",url:"/MProduct/GetProductList",params:{token:this.Cookie.get("Ticket"),keyword:this.search,pageIndex:this.currentPage,pageSize:this.pageSize}}).then(function(e){e.status,t.tableData=e.data,t.total=e.all_count,t.loading=!1}).catch(function(){t.loading=!1})}),s()(a,"searchKeyword",function(){this.currentPage=1,this.handleCurrentChange(this.currentPage)}),a)},m={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"jointRent-container"},[o("div",{staticClass:"announcement-header"},[o("div",{staticClass:"header-left"},[o("b",[t._v("管理")]),t._v(" "),o("span",[t._v("共 "+t._s(t.total)+" 条")])]),t._v(" "),o("div",{staticClass:"header-right"},[o("router-link",{attrs:{to:"/jointRent/rentOperate/0?from=jointRent",title:"新增"}},[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"}})],1)],1)]),t._v(" "),o("div",{staticClass:"announcement-list"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark",border:"",stripe:""},on:{"selection-change":t.handleSelectionChange}},[o("el-table-column",{attrs:{prop:"roimage",label:"图片",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[null!=e.row.roimage?o("img",{staticClass:"product-img",attrs:{src:e.row.roimage}}):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"rorenttype",label:"分类",align:"center","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"roname",label:"名称",align:"center","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"roarea",label:"面积",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.roarea)+"㎡")])]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"roshowprice",label:"价格",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v("￥"+t._s(e.row.roshowprice)+"/"+t._s("month"==e.row.roshowpriceunit?"月":"晚"))])]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"rodecorationstyle",label:"装修类型",align:"center","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"face",label:"朝向",align:"center","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"is_new",label:"是否在首页显示",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-switch",{attrs:{"active-value":!0,"inactive-value":!1},on:{change:function(o){return t.setShowHome(o,e.row)}},model:{value:e.row.show_index,callback:function(o){t.$set(e.row,"show_index",o)},expression:"scope.row.show_index"}})]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"name",label:"卧室操作",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[o("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",title:"编辑"},on:{click:function(o){t.editRoom(e.row.roid)}}})],1)]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"name",label:"房源操作",align:"center",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[o("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",title:"编辑"},on:{click:function(o){t.handleEdit(e.row.roid)}}}),t._v(" "),o("el-button",{staticClass:"el-icon-delete",attrs:{size:"mini",type:"danger",title:"删除"},on:{click:function(o){t.handleDelete(e.row.roid)}}})],1)]}}])})],1),t._v(" "),o("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next, jumper, ->","current-page":t.currentPage,"page-size":t.pageSize,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e}}})],1),t._v(" "),o("el-dialog",{attrs:{title:"修改卧室信息",center:"",visible:t.showStatus,width:"800px","before-close":t.handleClose},on:{"update:visible":function(e){t.showStatus=e}}},[o("div",{staticClass:"form-content"},[o("div",{staticClass:"operate-btn"},[t.roomInfo.num-t.roomInfo.roomData.length&&!t.showRoomOperate&&!t.showRoomOperateNo?o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.showRoomOperate=!0,t.editBedRoom=!1}}},[t._v("添加未入住")]):t._e(),t._v(" "),t.roomInfo.num-t.roomInfo.roomData.length&&!t.showRoomOperate&&!t.showRoomOperateNo?o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.showRoomOperateNo=!0,t.editBedRoom=!1}}},[t._v("添加已入住")]):t._e(),t._v(" "),o("span",[t._v("共有"+t._s(t.roomInfo.num)+"个卧室，还剩"+t._s(t.roomInfo.num-t.roomInfo.roomData.length)+"个未添加")])],1),t._v(" "),t.showRoomOperate||t.showRoomOperateNo?t._e():o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.roomInfo.roomData}},[o("el-table-column",{attrs:{prop:"bbrnum",label:"卧室编号"}}),t._v(" "),o("el-table-column",{attrs:{prop:"status",label:"卧室状态"}}),t._v(" "),o("el-table-column",{attrs:{prop:"name",label:"价格（性别）"},scopedSlots:t._u([{key:"default",fn:function(e){return["未租出"==e.row.status?o("span",[t._v("￥"+t._s(e.row.bbrshowprice)+"/"+t._s("month"==e.row.bbrshowpriceunit?"月":"晚"))]):o("span",[t._v(t._s(e.row.user.usgender))])]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"name",label:"操作",align:"center",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[o("el-dropdown",{on:{command:function(o){return t.handleEditRoom(o,e.row)}}},[o("span",{staticClass:"el-dropdown-link"},[o("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",title:"编辑"}})],1),t._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{command:!1}},[t._v("更新未入住")]),t._v(" "),o("el-dropdown-item",{attrs:{command:!0}},[t._v("更新已入住")])],1)],1),t._v(" "),o("el-button",{staticClass:"el-icon-delete",attrs:{size:"mini",type:"danger",title:"删除"},on:{click:function(o){t.handleDeleteRoom(e.row.bbrid)}}})],1)]}}])})],1),t._v(" "),t.showRoomOperate?o("div",{staticClass:"operate-room"},[o("el-form",{ref:"roomData",attrs:{model:t.roomData,"label-width":"100px",rules:t.roomDataRules}},[o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"卧室号：",prop:"bbrnum"}},[o("el-input-number",{staticStyle:{width:"150px"},attrs:{step:1,min:1},model:{value:t.roomData.bbrnum,callback:function(e){t.$set(t.roomData,"bbrnum",e)},expression:"roomData.bbrnum"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"价格：",prop:"bbrshowprice"}},[o("el-input-number",{staticStyle:{width:"150px"},attrs:{step:.01,min:0},model:{value:t.roomData.bbrshowprice,callback:function(e){t.$set(t.roomData,"bbrshowprice",e)},expression:"roomData.bbrshowprice"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"价格单位：",prop:"bbrshowpriceunit"}},[o("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:t.roomData.bbrshowpriceunit,callback:function(e){t.$set(t.roomData,"bbrshowpriceunit",e)},expression:"roomData.bbrshowpriceunit"}},[o("el-option",{attrs:{label:"月",value:"month"}}),t._v(" "),o("el-option",{attrs:{label:"晚",value:"night"}})],1)],1)],1)],1)],1)],1):t._e(),t._v(" "),t.showRoomOperateNo?o("div",{staticClass:"operate-room"},[o("el-form",{ref:"roomDataNo",attrs:{model:t.roomDataNo,"label-width":"100px",rules:t.roomDataNoRules}},[o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"卧室号：",prop:"bbrnum"}},[o("el-input-number",{staticStyle:{width:"150px"},attrs:{step:1,min:1},model:{value:t.roomDataNo.bbrnum,callback:function(e){t.$set(t.roomDataNo,"bbrnum",e)},expression:"roomDataNo.bbrnum"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"性别：",prop:"usgender"}},[o("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:t.roomDataNo.usgender,callback:function(e){t.$set(t.roomDataNo,"usgender",e)},expression:"roomDataNo.usgender"}},[o("el-option",{attrs:{label:"男",value:0}}),t._v(" "),o("el-option",{attrs:{label:"女",value:1}})],1)],1)],1)],1)],1)],1):t._e()],1),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.showRoomOperate?o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.submitRoom("roomData")}}},[t._v("保存")]):t._e(),t._v(" "),t.showRoomOperateNo?o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.submitRoom("roomDataNo")}}},[t._v("保存")]):t._e(),t._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:t.close}},[t._v("关闭")])],1)])],1)},staticRenderFns:[]};var c=o("VU/8")(l,m,!1,function(t){o("Mr/s")},null,null);e.default=c.exports}});