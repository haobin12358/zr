webpackJsonp([4],{"15hJ":function(e,t,a){"use strict";var i=a("zL8q"),s={props:["inputLocation","city"],data:function(){return{address_detail:null,userlocation:{lng:"",lat:""}}},watch:{inputLocation:function(){this.address_detail=this.inputLocation}},mounted:function(){this.$nextTick(function(){var e,t=this,a=new BMap.Map("allmap"),s=new BMap.Point(121.160724,31.173277);a.centerAndZoom(s,15),a.enableScrollWheelZoom(),new BMap.Autocomplete({input:"suggestId",location:a}).addEventListener("onconfirm",function(s){var l=s.item.value;if(-1==(e=l.province+l.city+l.district+l.street+l.business).indexOf("市")||-1==t.city.indexOf(e.slice(0,e.indexOf("市")+1)))return Object(i.Message)({message:"所选小区不在该城市",type:"error"}),t.address_detail=null,!1;t.address_detail=e,function(){a.clearOverlays();var i=new BMap.LocalSearch(a,{onSearchComplete:function(){t.userlocation=i.getResults().getPoi(0).point,t.$emit("getLocation",t.address_detail,t.userlocation),a.centerAndZoom(t.userlocation,18),a.addOverlay(new BMap.Marker(t.userlocation))}});i.search(e),a.addEventListener("click",function(e){console.log(t.userlocation.lng),console.log(t.userlocation.lat)})}()})})}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"all"}},[a("el-form-item",{attrs:{label:"小区名称：",rules:[{required:!0,message:"请选择",trigger:"change"}]}},[a("el-input",{staticStyle:{width:"200px"},attrs:{id:"suggestId",placeholder:"请输入具体位置",size:"small"},on:{blur:function(t){e.$emit("watchCity")}},model:{value:e.address_detail,callback:function(t){e.address_detail=t},expression:"address_detail"}}),e._v(" "),a("span",{staticStyle:{color:"#999"}},[e._v("请从下拉选择")])],1),e._v(" "),a("div",{attrs:{id:"allmap"}})],1)},staticRenderFns:[]};var r=a("VU/8")(s,l,!1,function(e){a("NjWH")},"data-v-2fa6116d",null);t.a=r.exports},"9s8R":function(e,t){},NjWH:function(e,t){},Qc8q:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),s=a.n(i),l=a("F+jZ"),r=a("zL8q"),o={name:"productMesOperate",components:{MainMap:a("15hJ").a},data:function(){return{ID:this.$route.params.id?this.$route.params.id:0,cityInfo:[],isshow:!1,vpi:{},formData:{vpi:[],paList:[{name:"",flag:0,sex:0}],ppList:[]},attr:[],fileUploadUrl:l.b,fileList:[],params:{},rules:{},isIndeterminate:!1,checkedPro:[],checkAll:!1,project:[{id:0,name:"衣柜"},{id:1,name:"WIFI"},{id:2,name:"冰箱"},{id:3,name:"电视"},{id:4,name:"洗衣机"},{id:5,name:"热水器"},{id:6,name:"桌椅"},{id:7,name:"鞋柜"},{id:8,name:"空调"}]}},created:function(){0!=this.ID&&this.getData()},methods:{getLocation:function(e,t){console.log(e,t)},handleCheckAllChange:function(e){var t=[];if(this.checkedPro=e?this.project:[],1==e){for(var a=0;a<this.project.length;a++)t.push(this.project[a].id);this.checkedPro=t}this.isIndeterminate=!1},handleCheckedProChange:function(e){var t=e.length;this.checkAll=t===this.project.length,this.isIndeterminate=t>0&&t<this.project.length},getWinHeight:l.d,handleAddress:function(e){var t=e[0]+"-"+e[1]+"-"+e[2];this.vpi.shopping_address=t},removeLine:function(e){this.formData.paList.splice(e,1)},addLine:function(){this.formData.paList.push({name:"",flag:0,sex:0})},getData:function(){var e=this;this.$http({method:"get",url:"MProduct/GetProductDetail",params:{product_id:this.ID}}).then(function(t){if(0==t.Status&&t.Result.ppList)for(var a=0;a<t.Result.ppList.length;a++)t.Result.ppList[a].pic_path&&e.fileList.push({name:t.Result.ppList[a].pic_path,url:t.Result.ppList[a].pic_path,id:t.Result.ppList[a].pic_path.slice(t.Result.ppList[a].pic_path.lastIndexOf("/")+1,t.Result.ppList[a].pic_path.lastIndexOf("."))})})},submitForm:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;var i={obj:s()(t.formData),token:t.Cookie.get("Ticket")};t.$refs[e].validate(function(e){if(e){var a="MProduct/AddProduct",s="post";0!=t.ID&&(a="MProduct/EditProduct",s="post"),t.$http({method:s,url:a,data:i}).then(function(e){0==e.Status?(Object(r.Message)({message:"操作成功",type:"success"}),t.$router.push("/productMan/productMes")):Object(r.Message)({message:e.Message,type:"error"})})}})})},resetForm:function(e){this.$refs[e].resetFields()},handlePreview:function(e){},submitUpload:function(e){this.$refs[e].submit()},successFile:function(e){this.formData.ppList.push({pic_path:e[0].Result.file_path})},beforeRemove:function(e){var t=this;return Object(r.MessageBox)({title:"提示",message:"确定移除 "+e.name+"？",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(a,i,s){return"confirm"===a?(s(),e.id&&t.$http.post("/File/DeleteFile?fileID="+e.id).then(function(a){var i=[];t.formData.ppList.map(function(t,a){t.pic_path!=e.name&&i.push(t)}),t.formData.ppList=i;var s=[];t.fileList.map(function(t,a){t.id!=e.id&&s.push(t)}),t.fileList=s}).catch(function(e){}),!0):(s(),!1)}})}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"service-operate-conatiner"},[a("div",{staticClass:"help-content-operate-header"},[a("b",[e._v(e._s(0!=e.$route.params.id?"编辑":"添加"))]),e._v(" "),a("router-link",{attrs:{to:"/rental"}},[a("el-button",[e._v("返回")])],1)],1),e._v(" "),a("el-form",{ref:"formData",staticClass:"operate-dialog-form",style:{height:e.getWinHeight()-252+"px"},attrs:{model:e.vpi,"label-width":"140px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"basic-message"},[a("p",{staticClass:"title"},[e._v("基本信息")]),e._v(" "),a("el-form-item",{attrs:{label:"房源名称：",prop:"product_name",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入房源名称",size:"small"},model:{value:e.vpi.product_name,callback:function(t){e.$set(e.vpi,"product_name",t)},expression:"vpi.product_name"}})],1),e._v(" "),a("main-map",{attrs:{inputLocation:e.vpi.location},on:{getLocation:e.getLocation}}),e._v(" "),a("el-form-item",{attrs:{label:"价格（月）：",prop:"product_unit",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入产品单位。",size:"small"},model:{value:e.vpi.product_unit,callback:function(t){e.$set(e.vpi,"product_unit",t)},expression:"vpi.product_unit"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格（季）：",prop:"product_unit",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入产品单位。",size:"small"},model:{value:e.vpi.product_unit,callback:function(t){e.$set(e.vpi,"product_unit",t)},expression:"vpi.product_unit"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格（年）：",prop:"product_unit",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入产品单位。",size:"small"},model:{value:e.vpi.product_unit,callback:function(t){e.$set(e.vpi,"product_unit",t)},expression:"vpi.product_unit"}})],1)],1),e._v(" "),a("div",{staticClass:"img-message"},[a("p",{staticClass:"title"},[e._v("图片信息")]),e._v(" "),a("el-form-item",{attrs:{label:"产品照片："}},[a("el-upload",{ref:"upload",staticClass:"upload",attrs:{action:e.fileUploadUrl,"on-preview":e.handlePreview,"on-success":e.successFile,"before-remove":e.beforeRemove,data:e.params,"file-list":e.fileList,accept:"image/jpeg,image/png,image/jpg",limit:5,"auto-upload":!0,"list-type":"picture"}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("点击上传文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，不超过5张图片")])],1)],1)],1),e._v(" "),a("div",{staticClass:"img-message"},[a("p",{staticClass:"title"},[e._v("周边设施")]),e._v(" "),a("el-form-item",{attrs:{label:"周边设施：",prop:"product_name",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"200px"},attrs:{type:"textarea",placeholder:"请输入",size:"small"},model:{value:e.vpi.product_name,callback:function(t){e.$set(e.vpi,"product_name",t)},expression:"vpi.product_name"}})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"img-message"},[a("p",{staticClass:"title"},[e._v("房源介绍")]),e._v(" "),a("el-form-item",{attrs:{label:"规格：",prop:"product_name",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入规格，如一室一厅",size:"small"},model:{value:e.vpi.product_name,callback:function(t){e.$set(e.vpi,"product_name",t)},expression:"vpi.product_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"面积（㎡）：",prop:"product_name",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入面积",size:"small"},model:{value:e.vpi.product_name,callback:function(t){e.$set(e.vpi,"product_name",t)},expression:"vpi.product_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"装修类型：",prop:"product_name",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入装修，如精装",size:"small"},model:{value:e.vpi.product_name,callback:function(t){e.$set(e.vpi,"product_name",t)},expression:"vpi.product_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"租赁方式：",prop:"region",rules:[{required:!0,message:"请选择",trigger:"blur"}]}},[a("el-select",{attrs:{placeholder:"请选择租赁方式"},model:{value:e.vpi.region,callback:function(t){e.$set(e.vpi,"region",t)},expression:"vpi.region"}},[a("el-option",{attrs:{label:"整租",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"合租",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"朝向：",prop:"product_name",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入朝向，如南北",size:"small"},model:{value:e.vpi.product_name,callback:function(t){e.$set(e.vpi,"product_name",t)},expression:"vpi.product_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"楼层：",prop:"product_name",rules:[{required:!0,message:"请输入",trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入楼层",size:"small"},model:{value:e.vpi.product_name,callback:function(t){e.$set(e.vpi,"product_name",t)},expression:"vpi.product_name"}})],1)],1),e._v(" "),a("div",{staticClass:"img-message"},[a("p",{staticClass:"title"},[e._v("房源配置")]),e._v(" "),a("el-form-item",{attrs:{label:"基本配置：",prop:"product_name",rules:[{required:!0,message:"请选择",trigger:"blur"}]}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),a("el-checkbox-group",{on:{change:e.handleCheckedProChange},model:{value:e.checkedPro,callback:function(t){e.checkedPro=t},expression:"checkedPro"}},e._l(e.project,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])}))],1)],1),e._v(" "),a("div",{staticClass:"img-message"},[a("p",{staticClass:"title"},[e._v("房间信息")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.formData.paList}},[a("el-table-column",{attrs:{prop:"name",label:"卧室名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticStyle:{width:"95%"},attrs:{size:"small"},model:{value:t.row.name,callback:function(a){e.$set(t.row,"name",a)},expression:"scope.row.name"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"flag",label:"是否入驻",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择"},model:{value:t.row.flag,callback:function(a){e.$set(t.row,"flag",a)},expression:"scope.row.flag"}},[a("el-option",{attrs:{label:"未入驻",value:0}}),e._v(" "),a("el-option",{attrs:{label:"已入驻",value:1}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sex",label:"性别",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择"},model:{value:t.row.sex,callback:function(a){e.$set(t.row,"sex",a)},expression:"scope.row.sex"}},[a("el-option",{attrs:{label:"男",value:0}}),e._v(" "),a("el-option",{attrs:{label:"女",value:1}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"A",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"delete el-icon-circle-close",on:{click:function(a){e.removeLine(t.$index)}}})]}}])})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("el-button",{attrs:{type:"success"},on:{click:e.addLine}},[e._v("添加一行")])],1)],1)])],1),e._v(" "),a("el-row",[a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.submitForm("formData")}}},[e._v("提交")]),e._v(" "),a("router-link",{attrs:{to:"/productMan/productMes"}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.resetForm("formData")}}},[e._v("返回")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(o,n,!1,function(e){a("9s8R")},null,null);t.default=c.exports},mvHQ:function(e,t,a){e.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(e,t,a){var i=a("FeBl"),s=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function(e){return s.stringify.apply(s,arguments)}}});