webpackJsonp([36],{"Wy/x":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("F+jZ"),i=a("zL8q"),l={data:function(){return{total:0,search:"",tableData:[],loading:!1,nowPage:1,pageSize:10,showDetail:!1,detailData:{},showPrice:!1,priceData:{price:null},priceRules:{price:[{required:!0,message:"请输入",trigger:"change"}]},showStatus:!1,statusData:{status:null,agree:1},statusRules:{status:[{required:!0,message:"请选择",trigger:"change"}],agree:[{required:!0,message:"请选择",trigger:"change"}]},showPeople:!1,peopleOption:[],peopleData:{stfid:null},peopleRules:{stfid:[{required:!0,message:"请选择",trigger:"change"}]}}},components:{},created:function(){this.getData()},methods:{changePrice:function(t){this.showPrice=!0,this.priceData.uctid=t.uctid,this.priceData.price=t.uctprice},submitPrice:function(t){var e=this;this.$refs[t].validate(function(t){e.$http({method:"post",url:"/trade/update_cleanerorder_price/",data:e.priceData,params:{token:e.Cookie.get("token")}}).then(function(t){200==t.status?(Object(i.Message)({message:t.message,type:"success",showClose:!0}),e.showPrice=!1,e.getData()):Object(i.Message)({message:t.message,type:"error",showClose:!0})})})},changeStatus:function(t){this.showStatus=!0,this.statusData.uctid=t.uctid,this.statusData.status="待支付"==t.uctstatus?0:"等待服务"==t.uctstatus?1:"服务完成"==t.uctstatus?2:"申请退款"==t.uctstatus?3:"已同意退款"==t.uctstatus?4:5},submitStatus:function(t){var e=this;3==this.statusData.status?(delete this.statusData.status,this.$refs[t].validate(function(t){e.$http({method:"post",url:"/trade/agree_cancel_clean_order/",data:e.statusData,params:{token:e.Cookie.get("token")}}).then(function(t){200==t.status?(Object(i.Message)({message:t.message,type:"success",showClose:!0}),e.showStatus=!1,e.getData()):Object(i.Message)({message:t.message,type:"error",showClose:!0})})})):(delete this.statusData.agree,this.$refs[t].validate(function(t){e.$http({method:"post",url:"/trade/update_cleanorder_status/",data:e.statusData,params:{token:e.Cookie.get("token")}}).then(function(t){200==t.status?(Object(i.Message)({message:t.message,type:"success",showClose:!0}),e.showStatus=!1,e.getData()):Object(i.Message)({message:t.message,type:"error",showClose:!0})})}))},getPeople:function(t){var e=this;this.$http.get("/user/staff_list/",{level:"2",city_id:t}).then(function(t){200==t.status?e.peopleOption=t.data.staff:e.peopleOption=[]})},changePeople:function(t){this.showPeople=!0,this.getPeople(t.citynum),this.peopleData.uctid=t.uctid},submitPeople:function(t){var e=this;this.$refs[t].validate(function(t){e.$http({method:"post",url:"/trade/point_staff/",data:e.peopleData,params:{token:e.Cookie.get("token")}}).then(function(t){200==t.status?(Object(i.Message)({message:t.message,type:"success",showClose:!0}),e.showPeople=!1,e.getData()):Object(i.Message)({message:t.message,type:"error",showClose:!0})})})},filterTime:function(t){if(t)return t.slice(0,4)+"-"+t.slice(4,6)+"-"+t.slice(6,8)+" "+t.slice(8,10)+":"+t.slice(10,12)},handleClose:function(t){t()},getWinHeight:s.d,searchData:function(){this.nowPage=1,this.handleCurrentChange(this.nowPage)},handleDelete:function(t,e){t.stopPropagation()},handleCurrentChange:function(t){this.nowPage=t,this.getData(this.search)},toOrderDetail:function(t){this.showDetail=!0,this.detailData=t},getData:function(){var t=this;this.$http({method:"GET",url:"/trade/get_appointment_list/",params:{token:this.Cookie.get("token"),type:"cleaner",page:this.nowPage,count:this.pageSize}}).then(function(e){200==e.status?(t.tableData=e.data,t.total=e.all_count):(t.tableData=[],t.total=null,Object(i.Message)({type:"error",message:e.message,duration:1e3}))})},ConfirmOrder:function(t,e){t.stopPropagation(),this.$http({method:"POST",url:"POrder/MConfirmOrder",data:{token:this.Cookie.get("Ticket"),orderID:e}}).then(function(t){200==t.status?Object(i.Message)({type:"success",message:t.message,duration:1e3}):Object(i.Message)({type:"error",message:t.message,duration:1e3})})}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"orderMan-container"},[a("div",{staticClass:"announcement-header"},[a("div",{staticClass:"header-left"},[a("b",[t._v("管理")]),t._v(" "),a("span",[t._v("共 "+t._s(t.total)+" 条")])]),t._v(" "),a("div",{staticClass:"header-right"},[a("el-input",{staticClass:"input-with-select search",attrs:{size:"mini",placeholder:"请输入搜索文字"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search",title:"搜索"},on:{click:function(e){t.searchData()}},slot:"append"})],1)],1)]),t._v(" "),a("div",{staticClass:"announcement-list"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark",border:"",stripe:""}},[a("el-table-column",{attrs:{prop:"uctcreatetime",label:"订单号",align:"center",width:"185"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"订单类型",align:"center",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"uctaddr",label:"服务地址",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"uctpreviewlastingtime",label:"预约时长（小时）",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"uctpreviewstarttime",label:"预约时间",align:"center",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.filterTime(e.row.uctpreviewstarttime))+"\n                ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"uctprice",label:"金额（元）",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{display:"inline-block",width:"60px"}},[t._v(t._s(e.row.uctprice))]),t._v(" "),a("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",title:"修改价格"},on:{click:function(a){t.changePrice(e.row)}}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"uctphone",label:"用户手机号",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"staff",label:"分配保洁人员",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{display:"inline-block",width:"60px"}},[t._v(t._s(e.row.staff.stfname))]),t._v(" "),"等待服务"==e.row.uctstatus?a("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",title:"分配人员"},on:{click:function(a){t.changePeople(e.row)}}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"uctstatus",label:"订单状态",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return["服务完成"==e.row.uctstatus?a("span",{staticStyle:{color:"#4EAF24",display:"inline-block",width:"60px"}},[t._v(t._s(e.row.uctstatus))]):t._e(),t._v(" "),"待支付"==e.row.uctstatus?a("span",{staticStyle:{color:"#409EFF",display:"inline-block",width:"60px"}},[t._v(t._s(e.row.uctstatus))]):t._e(),t._v(" "),"等待服务"==e.row.uctstatus?a("span",{staticStyle:{color:"#999",display:"inline-block",width:"60px"}},[t._v(t._s(e.row.uctstatus))]):t._e(),t._v(" "),"交易关闭"==e.row.uctstatus?a("span",{staticStyle:{color:"#000",display:"inline-block",width:"60px"}},[t._v(t._s(e.row.uctstatus))]):t._e(),t._v(" "),"申请退款"==e.row.uctstatus?a("span",{staticStyle:{color:"red",display:"inline-block",width:"60px"}},[t._v(t._s(e.row.uctstatus))]):t._e(),t._v(" "),"已同意退款"==e.row.uctstatus?a("span",{staticStyle:{color:"red",display:"inline-block",width:"60px"}},[t._v(t._s(e.row.uctstatus))]):t._e(),t._v(" "),"待支付"==e.row.uctstatus||"等待服务"==e.row.uctstatus||"申请退款"==e.row.uctstatus?a("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",title:"修改订单状态"},on:{click:function(a){t.changeStatus(e.row)}}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"操作",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("el-button",{staticClass:"el-icon-zoom-in",attrs:{size:"mini",title:"查看",type:"primary"},on:{click:function(a){t.toOrderDetail(e.row)}}})],1)]}}])})],1),t._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next, jumper, ->","current-page":t.nowPage,"page-size":t.pageSize,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.nowPage=e}}})],1),t._v(" "),a("el-dialog",{attrs:{title:"订单详情",center:"",visible:t.showDetail,width:"500px","before-close":t.handleClose},on:{"update:visible":function(e){t.showDetail=e}}},[a("div",{staticClass:"form-content"},[a("header",{staticClass:"header"},[a("p",{staticClass:"line-one",staticStyle:{"font-size":"16px"}},[t._v(t._s(t.detailData.name))])]),t._v(" "),a("div",{staticClass:"form-item"},[a("div",{staticClass:"group"},[a("p",{staticClass:"item"},[t._v("上门时间")]),t._v(" "),a("input",{staticClass:"input",attrs:{type:"text",readonly:"true",placeholder:"请选择上门时间"},domProps:{value:t.filterTime(t.detailData.uctcreatetime)}})]),t._v(" "),a("span",{staticStyle:{display:"inline-block",width:"0.426667rem",height:"0.426667rem"}})]),t._v(" "),a("div",{staticClass:"form-item"},[a("div",{staticClass:"group"},[a("p",{staticClass:"item"},[t._v("服务地址")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailData.uctaddr,expression:"detailData.uctaddr"}],staticClass:"input",attrs:{type:"text",readonly:"true",placeholder:"请填写服务地址"},domProps:{value:t.detailData.uctaddr},on:{input:function(e){e.target.composing||t.$set(t.detailData,"uctaddr",e.target.value)}}})]),t._v(" "),a("span",{staticStyle:{display:"inline-block",width:"0.426667rem",height:"0.426667rem"}})]),t._v(" "),a("div",{staticClass:"form-item"},[a("div",{staticClass:"group"},[a("p",{staticClass:"item"},[t._v("服务时长（小时）")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailData.uctpreviewlastingtime,expression:"detailData.uctpreviewlastingtime"}],staticClass:"input",attrs:{type:"text",readonly:"true",placeholder:"请填写服务时长"},domProps:{value:t.detailData.uctpreviewlastingtime},on:{input:function(e){e.target.composing||t.$set(t.detailData,"uctpreviewlastingtime",e.target.value)}}})]),t._v(" "),a("span",{staticStyle:{display:"inline-block",width:"0.426667rem",height:"0.426667rem"}})]),t._v(" "),a("div",{staticClass:"form-item"},[a("div",{staticClass:"group"},[a("p",{staticClass:"item"},[t._v("联系电话")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailData.uctphone,expression:"detailData.uctphone"}],staticClass:"input",attrs:{type:"text",readonly:"true",placeholder:"请填写联系电话"},domProps:{value:t.detailData.uctphone},on:{input:function(e){e.target.composing||t.$set(t.detailData,"uctphone",e.target.value)}}})]),t._v(" "),a("span",{staticStyle:{display:"inline-block",width:"0.426667rem",height:"0.426667rem"}})]),t._v(" "),a("div",{staticClass:"form-item"},[a("div",{staticClass:"group"},[a("p",{staticClass:"item"},[t._v("备注")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.detailData.uctspecialwish,expression:"detailData.uctspecialwish"}],staticClass:"input",attrs:{type:"text",readonly:"true",placeholder:"请填写备注（选填）"},domProps:{value:t.detailData.uctspecialwish},on:{input:function(e){e.target.composing||t.$set(t.detailData,"uctspecialwish",e.target.value)}}})]),t._v(" "),a("span",{staticStyle:{display:"inline-block",width:"0.426667rem",height:"0.426667rem"}})]),t._v(" "),a("div",{staticClass:"some-order-detail"},[a("p",[t._v("下单时间："),a("span",[t._v(t._s(t.filterTime(t.detailData.uctcreatetime)))])]),t._v(" "),a("p",[t._v("总价："),a("span",[t._v("￥ "+t._s(t.detailData.uctprice))])]),t._v(" "),a("p",[t._v("订单状态："),a("span",[t._v(t._s(t.detailData.uctstatus))])])])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.showDetail=!1}}},[t._v("关闭")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"修改订单价格",center:"",visible:t.showPrice,width:"500px","before-close":t.handleClose},on:{"update:visible":function(e){t.showPrice=e}}},[a("div",{staticClass:"form-content"},[a("el-form",{ref:"priceData",attrs:{model:t.priceData,"label-width":"80px",rules:t.priceRules}},[a("el-form-item",{attrs:{label:"价格：",prop:"price"}},[a("el-input-number",{staticStyle:{width:"200px"},attrs:{step:.01,min:0},model:{value:t.priceData.price,callback:function(e){t.$set(t.priceData,"price",e)},expression:"priceData.price"}})],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.submitPrice("priceData")}}},[t._v("保存")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.showPrice=!1}}},[t._v("关闭")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"修改订单状态",center:"",visible:t.showStatus,width:"500px","before-close":t.handleClose},on:{"update:visible":function(e){t.showStatus=e}}},[a("div",{staticClass:"form-content"},[a("el-form",{ref:"statusData",attrs:{model:t.statusData,"label-width":"100px",rules:t.statusRules}},[3!=t.statusData.status?a("el-form-item",{attrs:{label:"订单状态：",prop:"status"}},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:t.statusData.status,callback:function(e){t.$set(t.statusData,"status",e)},expression:"statusData.status"}},[a("el-option",{attrs:{label:"待支付",value:0}}),t._v(" "),a("el-option",{attrs:{label:"等待服务",value:1}}),t._v(" "),a("el-option",{attrs:{label:"服务完成",value:2}}),t._v(" "),a("el-option",{attrs:{label:"交易关闭",value:5}})],1)],1):a("el-form-item",{attrs:{label:"是否退款：",prop:"agree"}},[a("el-radio-group",{model:{value:t.statusData.agree,callback:function(e){t.$set(t.statusData,"agree",e)},expression:"statusData.agree"}},[a("el-radio",{attrs:{label:1}},[t._v("同意")]),t._v(" "),a("el-radio",{attrs:{label:0}},[t._v("不同意")])],1)],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.submitStatus("statusData")}}},[t._v("保存")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.showStatus=!1}}},[t._v("关闭")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"分配保洁人员",center:"",visible:t.showPeople,width:"500px","before-close":t.handleClose},on:{"update:visible":function(e){t.showPeople=e}}},[a("div",{staticClass:"form-content"},[a("el-form",{ref:"peopleData",attrs:{model:t.peopleData,"label-width":"100px",rules:t.peopleRules}},[a("el-form-item",{attrs:{label:"备选人员：",prop:"stfid"}},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:t.peopleData.stfid,callback:function(e){t.$set(t.peopleData,"stfid",e)},expression:"peopleData.stfid"}},t._l(t.peopleOption,function(t,e){return a("el-option",{key:e,attrs:{label:t.stfname,value:t.stfid}})}))],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.submitPeople("peopleData")}}},[t._v("保存")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.showPeople=!1}}},[t._v("关闭")])],1)])],1)},staticRenderFns:[]};var n=a("VU/8")(l,o,!1,function(t){a("os9J")},null,null);e.default=n.exports},os9J:function(t,e){}});